<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE urlrewrite PUBLIC "-//tuckey.org//DTD UrlRewrite 4.0//EN"
        "http://www.tuckey.org/res/dtds/urlrewrite4.0.dtd">
<urlrewrite use-context="false" decode-using="utf-8">
    
    <rule enabled="true" match-type="regex">
        <note>Route to viewing Swagger documentation.</note>
        <from>^/docs$</from>
        <to type="redirect" last="true">http://%{server-name}:%{port}%{context-path}/swagger/index.html?url=%{context-path}/api/v1</to>
    </rule>
    
    <rule enabled="true" match-type="regex">
        <note>Reject request outwith designated root locations.</note>
        <from>^((?!/api/v1|/swagger/|/api-docs|/error).)*$</from>
        <!--when no referer header set-->
        <condition type="header" name="referer" operator="notequal">^.+$</condition>
        <to last="true">nocontent</to>
    </rule>

    <rule enabled="true" match-type="regex">
        <note>/api/v1/hardware</note>
        <from>^/api/v1/([a-z]+)$</from>
        <to last="true">/$1</to>
    </rule>

    <rule enabled="true" match-type="regex">
        <note>/api/v1/images</note>
        <from>^/api/v1/([a-z]+)$</from>
        <to last="true">/$1</to>
    </rule>

    <rule enabled="true" match-type="regex">
        <note>/api/v1/hardware/57343897deb25235ed152655</note>
        <from>^/api/v1/([a-z]+)/([a-z0-9]+)$</from>
        <to last="true">/$1/$2</to>
    </rule>
    
    <rule enabled="true" match-type="regex">
        <note>/api/v1/hardware/57343897deb25235ed152655/delete</note>
        <from>^/api/v1/([a-z]+)/([a-z0-9]+)/delete$</from>
        <to last="true">/$1/$2/delete</to>
    </rule>
    
    <rule enabled="true" match-type="regex">
        <note>api/v1/hardware/manufacturer/Samsung</note>
        <from>^/api/v1/([a-z]+)/([a-z]+)/([a-z0-9]+)$</from>
        <to last="true">/$1/$2/$3</to>
    </rule>

</urlrewrite>
